---
import type { GetStaticPaths } from 'astro';
import { getCollection, getEntry, render } from 'astro:content';
import BlogArticle from '../../layouts/BlogArticle.astro';

export const getStaticPaths: GetStaticPaths = async () => {
  const allPosts = await getCollection('blog');
  return allPosts.map(post => ({
    params: { page: post.id },
  }));
};

const { page: postId } = Astro.params;
const post = await getEntry('blog', postId as string);

if (!post) {
    return Astro.redirect('/404');
}

const { Content, headings } = await render(post);
---

<BlogArticle frontmatter={post.data} headings={headings}>
  <Content />
</BlogArticle>