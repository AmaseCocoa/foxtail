---
import type { Page, GetStaticPaths } from 'astro';
import type { CollectionEntry } from 'astro:content';
import { getCollection } from 'astro:content';
import BlogLayout from "../../layouts/BlogLayout.astro";
import BlogProfile from "../../components/BlogProfile.astro";
import RecentPosts from "../../components/RecentPosts.astro";
import ArticleCard from "../../components/ArticleCard.astro";
import Pagination from '../../components/Pagination.astro';

export const getStaticPaths: GetStaticPaths = async ({ paginate }) => {
  const allPosts = (await getCollection('blog')).filter(p => p.slug.startsWith('ja/'));
  allPosts.sort((a, b) => new Date(b.data.createdAt).getTime() - new Date(a.data.createdAt).getTime());
  return paginate(allPosts, { pageSize: 5 });
};

const { page } = Astro.props as { page: Page<CollectionEntry<'blog'>> };
---

<BlogLayout title="Note" description="amase.cc blog" thumbnail="" noindex="true">
    <div class="mb-4">
    	<h1 class="text-2xl font-bold">Note</h1>
     	<p>てきとうにやってます</p>
    </div>
	
    <ul>
        {page.data.map((post) => <li class="mb-5">
            <ArticleCard url={`/articles/${post.slug.replace(/^ja\//, '')}`} title={post.data.title} pubDate={post.data.createdAt} description={post.data.description} tags={post.data.tags} />
        </li>)}
    </ul>
    <Pagination page={page} />
    <div slot="sidebar">
        <BlogProfile />
        <RecentPosts />
    </div>
</BlogLayout>