---
import FallbackLink from "./LegacyLink.astro";

let useFallback: boolean = false;
let iframeSource: string | null = null;

interface Props {
    url: string;
    allowPlayer?: boolean;
}

const { url, allowPlayer = false } = Astro.props;

if (!process.env.SS_OGP) {
    useFallback = true;
} else {
    iframeSource = `${process.env.SS_OGP}/card?url=${url}&allowPlayer=${allowPlayer}`;
}
---

{
    !useFallback ? (
        <iframe
            src={iframeSource}
            class="ss-card w-full h-auto my-4 rounded-lg"
            loading="lazy"
            
        />
    ) : (
        <FallbackLink url={url} allowPlayer={allowPlayer} />
    )
}
